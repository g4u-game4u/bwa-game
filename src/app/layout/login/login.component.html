<div class="gradient-overlay">
  <img *ngIf="systemParams?.client_login_background_url?.value" [src]="systemParams?.client_login_background_url?.value"
    alt="Plano de fundo do login" class="login-background" draggable="false">

</div>
<div class="login-content">

  <div class="flex flex-col items-center md:!items-start">
    <div class="logo">
      <img *ngIf="clientLogoUrl" [src]="clientLogoUrl" [alt]="clientName" class="client-logo" draggable="false">
      <div *ngIf="!clientLogoUrl" class="default-logo"></div>
    </div>

    <img src="/assets/images/logo-bwa-white-inteira-full.png" alt="BWA Global" class="bwa-logo" draggable="false">

    <h2 class="text-center md:text-left">Bem-vindo de volta ao {{clientName}}!</h2>

    <h1 class="hidden md:!block">Ligando o Modo Turbo.</h1>
  </div>

  <!-- Login Form -->
  <c4u-card *ngIf="resetFlow === 'login'" [title]="'LABEL_LOGIN_SUBTITLE' | translate" align="center">
    <div class="login-form-container">
      <form class="login-form" (ngSubmit)="submit()" [formGroup]="form">
        <input type="text" placeholder="Login" formControlName="username" />
        <input type="password" placeholder="Senha" formControlName="password" />
        <div *ngIf="isLoading" class="loading-content">
          <c4u-spinner></c4u-spinner>
          <span>{{loadingText}}</span>
        </div>
        <div class="actions">
          <button class="login-btn" type="submit" [disabled]="isLoading || !form.valid">
            <span *ngIf="!isLoading">Entrar</span>
          </button>
          <button type="button" class="forgot-password-link" (click)="startPasswordReset()" [disabled]="isLoading">
            {{ 'LABEL_FORGOT_PASSWORD' | translate }}
          </button>
        </div>
      </form>
    </div>
  </c4u-card>

  <!-- Reset Request Form -->
  <c4u-card *ngIf="resetFlow === 'reset-request'" [title]="'LABEL_PASSWORD_RESET' | translate" align="center">
    <div class="login-form-container">
      <form class="login-form" (ngSubmit)="requestResetCode()" [formGroup]="resetRequestForm">
        <p class="reset-instructions">{{ 'LABEL_PASSWORD_RESET_INSTRUCTIONS' | translate }}</p>
        <input type="email" [placeholder]="'LABEL_EMAIL_PLACEHOLDER' | translate" formControlName="email" />
        <div *ngIf="resetRequestForm.get('email')?.invalid && resetRequestForm.get('email')?.touched" class="error-message">
          <span *ngIf="resetRequestForm.get('email')?.errors?.['required']">{{ 'LABEL_EMAIL_REQUIRED' | translate }}</span>
          <span *ngIf="resetRequestForm.get('email')?.errors?.['email']">{{ 'LABEL_EMAIL_INVALID' | translate }}</span>
        </div>
        <div *ngIf="isLoading" class="loading-content">
          <c4u-spinner></c4u-spinner>
          <span>{{loadingText}}</span>
        </div>
        <div class="actions">
          <button class="login-btn" type="submit" [disabled]="isLoading || !resetRequestForm.valid">
            <span *ngIf="!isLoading">{{ 'LABEL_SEND_CODE' | translate }}</span>
          </button>
          <button type="button" class="back-link" (click)="backToLogin()" [disabled]="isLoading">
            {{ 'LABEL_BACK_TO_LOGIN' | translate }}
          </button>
        </div>
      </form>
    </div>
  </c4u-card>

  <!-- Reset Confirm Form -->
  <c4u-card *ngIf="resetFlow === 'reset-confirm'" [title]="'LABEL_PASSWORD_RESET' | translate" align="center">
    <div class="login-form-container">
      <form class="login-form" (ngSubmit)="confirmResetPassword()" [formGroup]="resetConfirmForm">
        <p class="reset-instructions">{{ 'LABEL_CODE_SENT_TO' | translate }}: <strong>{{resetEmail}}</strong></p>
        <input type="text" [placeholder]="'LABEL_CODE_PLACEHOLDER' | translate" formControlName="code" maxlength="6" />
        <div *ngIf="resetConfirmForm.get('code')?.invalid && resetConfirmForm.get('code')?.touched" class="error-message">
          <span *ngIf="resetConfirmForm.get('code')?.errors?.['required']">{{ 'LABEL_CODE_REQUIRED' | translate }}</span>
          <span *ngIf="resetConfirmForm.get('code')?.errors?.['minlength']">{{ 'LABEL_CODE_MIN_LENGTH' | translate }}</span>
        </div>
        <input type="password" [placeholder]="'LABEL_NEW_PASSWORD_PLACEHOLDER' | translate" formControlName="newPassword" />
        <div *ngIf="resetConfirmForm.get('newPassword')?.invalid && resetConfirmForm.get('newPassword')?.touched" class="error-message">
          <span *ngIf="resetConfirmForm.get('newPassword')?.errors?.['required']">{{ 'LABEL_PASSWORD_REQUIRED' | translate }}</span>
          <span *ngIf="resetConfirmForm.get('newPassword')?.errors?.['minlength']">{{ 'LABEL_PASSWORD_MIN_LENGTH' | translate }}</span>
        </div>
        <input type="password" [placeholder]="'LABEL_CONFIRM_PASSWORD_PLACEHOLDER' | translate" formControlName="confirmPassword" />
        <div *ngIf="resetConfirmForm.get('confirmPassword')?.touched && resetConfirmForm.hasError('passwordMismatch')" class="error-message">
          {{ 'LABEL_PASSWORDS_DONT_MATCH' | translate }}
        </div>
        <div *ngIf="isLoading" class="loading-content">
          <c4u-spinner></c4u-spinner>
          <span>{{loadingText}}</span>
        </div>
        <div class="actions">
          <button class="login-btn" type="submit" [disabled]="isLoading || !resetConfirmForm.valid || resetConfirmForm.hasError('passwordMismatch')">
            <span *ngIf="!isLoading">{{ 'LABEL_RESET_PASSWORD' | translate }}</span>
          </button>
          <button type="button" class="back-link" (click)="backToLogin()" [disabled]="isLoading">
            {{ 'LABEL_BACK_TO_LOGIN' | translate }}
          </button>
        </div>
      </form>
    </div>
  </c4u-card>
</div>